<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MirroRehab.Controls.PrettySlider"
            HorizontalOptions="FillAndExpand"
            VerticalOptions="FillAndExpand">

    <Grid RowDefinitions="Auto" ColumnDefinitions="*"
          VerticalOptions="Center" HeightRequest="40">

        <!-- Слой трека/прогресса/тиков -->
        <Grid x:Name="TrackHost"
              Margin="8,12"
              VerticalOptions="FillAndExpand"
              HorizontalOptions="FillAndExpand">
            <!-- Базовый трек -->
            <Border x:Name="Track"
                    VerticalOptions="Center"
                    HeightRequest="10"
                    StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="6"/>
                </Border.StrokeShape>
                <Border.Background>
                    <SolidColorBrush Color="#EEEEEE"/>
                </Border.Background>
            </Border>

            <!-- Тики (опционально, добавляем из кода) -->
            <Grid x:Name="TicksLayer"/>

            <!-- Заполненная часть (градиент) -->
            <Border x:Name="Progress"
                    VerticalOptions="Center"
                    HeightRequest="10"
                    WidthRequest="0"
                    StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="6"/>
                </Border.StrokeShape>
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                        <GradientStop Color="LightCyan" Offset="0" />
                        <GradientStop Color="#0366D6" Offset="1" />
                    </LinearGradientBrush>
                </Border.Background>
            </Border>

            <!-- «Шайба» -->
            <Border x:Name="Thumb"
                    WidthRequest="22" HeightRequest="22"
                    StrokeThickness="0"
                    TranslationX="0" TranslationY="0">
                <Border.Shadow>
                    <Shadow Opacity="0.3" Radius="8"/>
                </Border.Shadow>
                <Border.StrokeShape>
                    <Ellipse />
                </Border.StrokeShape>
                <Border.Background>
                    <SolidColorBrush Color="White"/>
                </Border.Background>
            </Border>

            <!-- «Пузырёк» со значением -->
            <Frame x:Name="Bubble"
                   Padding="2,1"
                   CornerRadius="6"
                   HasShadow="False"
                   BackgroundColor="#0366D6"
                   TranslationY="-26"
                   IsVisible="{Binding ShowValueBubble, Source={x:Reference Root}}">
                <Label x:Name="BubbleText" FontSize="12" TextColor="White"/>
            </Frame>
        </Grid>

        <!-- Невидимый нативный Slider, ловит жесты -->
        <Slider x:Name="NativeSlider"
                Grid.Row="0"
                Minimum="{Binding Minimum, Source={x:Reference Root}}"
                Maximum="{Binding Maximum, Source={x:Reference Root}}"
                Value="{Binding Value, Source={x:Reference Root}, Mode=TwoWay}"
                Opacity="0.01"
                MinimumTrackColor="Transparent"
                MaximumTrackColor="Transparent"
                ThumbColor="Transparent"
                HorizontalOptions="FillAndExpand"
                VerticalOptions="FillAndExpand"/>
    </Grid>
</ContentView>
