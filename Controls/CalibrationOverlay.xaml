<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:behaviors="clr-namespace:MirroRehab.Behaviors"
             xmlns:controls ="clr-namespace:MirroRehab.Controls"
             x:Class="MirroRehab.Controls.CalibrationOverlay">
    <Frame x:Name="Root"
          BackgroundColor="#80000000"
          IsVisible="{Binding IsCalibrating}"
          InputTransparent="False"    
          HorizontalOptions="FillAndExpand"
          VerticalOptions="FillAndExpand"
          Padding="16"
          Margin="0"
          ZIndex="9999">
        <Frame HasShadow="True"
               CornerRadius="16"
               Padding="16"
               BackgroundColor="White"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               >
            <ScrollView>
                <VerticalStackLayout Spacing="16">

                    <Label Text="Калибровка пальцев"
                           FontSize="20"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"/>

                    <!-- сетка 5 строк (пальцы) x 5 колонок (лейбл + 2 слайдера с их значениями) -->
                    <Grid ColumnDefinitions="140,*,50,*,50"
                          RowDefinitions="Auto,Auto,Auto,Auto,Auto"
                          ColumnSpacing="12" RowSpacing="10">

                        <!-- Большой палец -->
                        <Label Grid.Row="0" Grid.Column="0" Text="Большой" VerticalOptions="Center"/>
                        <controls:PrettySlider Grid.Row="1"  Grid.Column="1"
                                               Minimum="0" Maximum="180"
                                               Step="5"
                                               ShowTicks="True" TickEvery="10"
                                               Value="{Binding IndexFlex, Mode=TwoWay}" />
                        <Label Grid.Row="0" Grid.Column="2"  Text="{Binding ThumbFlex, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Slider Grid.Row="0" Grid.Column="3"  Minimum="0" Maximum="180"
                                Value="{Binding ThumbExtend, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="0" Grid.Column="4" Text="{Binding ThumbExtend, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>

                        <!-- Указательный -->
                        <Label Grid.Row="1" Grid.Column="0" Text="Указательный" VerticalOptions="Center"/>
                        <Slider Grid.Row="1" Grid.Column="1" Minimum="0" Maximum="180"
                                Value="{Binding IndexFlex, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="1" Grid.Column="2" Text="{Binding IndexFlex, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Slider Grid.Row="1" Grid.Column="3" Minimum="0" Maximum="180"
                                Value="{Binding IndexExtend, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="1" Grid.Column="4" Text="{Binding IndexExtend, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>

                        <!-- Средний -->
                        <Label Grid.Row="2" Grid.Column="0" Text="Средний" VerticalOptions="Center"/>
                        <Slider Grid.Row="2" Grid.Column="1" Minimum="0" Maximum="180"
                                Value="{Binding MiddleFlex, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="2" Grid.Column="2" Text="{Binding MiddleFlex, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Slider Grid.Row="2" Grid.Column="3" Minimum="0" Maximum="180"
                                Value="{Binding MiddleExtend, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="2" Grid.Column="4" Text="{Binding MiddleExtend, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>

                        <!-- Безымянный -->
                        <Label Grid.Row="3" Grid.Column="0" Text="Безымянный" VerticalOptions="Center"/>
                        <Slider Grid.Row="3" Grid.Column="1" Minimum="0" Maximum="180"
                                Value="{Binding RingFlex, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="3" Grid.Column="2" Text="{Binding RingFlex, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Slider Grid.Row="3" Grid.Column="3" Minimum="0" Maximum="180"
                                Value="{Binding RingExtend, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="3" Grid.Column="4" Text="{Binding RingExtend, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>

                        <!-- Мизинец -->
                        <Label Grid.Row="4" Grid.Column="0" Text="Мизинец" VerticalOptions="Center"/>
                        <Slider Grid.Row="4" Grid.Column="1" Minimum="0" Maximum="180"
                                Value="{Binding PinkyFlex, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="4" Grid.Column="2" Text="{Binding PinkyFlex, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>
                        <Slider Grid.Row="4" Grid.Column="3" Minimum="0" Maximum="180"
                                Value="{Binding PinkyExtend, Mode=TwoWay}">
                            <Slider.Behaviors>
                                <behaviors:StepSliderBehavior Step="5"/>
                            </Slider.Behaviors>
                        </Slider>
                        <Label Grid.Row="4" Grid.Column="4" Text="{Binding PinkyExtend, StringFormat='{0:F0}°'}"
                               VerticalOptions="Center" HorizontalTextAlignment="Center"/>

                    </Grid>

                    <Grid ColumnDefinitions="*,*"
                          ColumnSpacing="12"
                          Margin="0,8,0,0">
                        <Button Grid.Column="0" Text="Отмена"
                                Command="{Binding CancelCalibrationCommand}" />
                        <Button Grid.Column="1" Text="Сохранить"
                                BackgroundColor="{DynamicResource Accent}"
                                Command="{Binding SaveCalibrationCommand}" />
                    </Grid>

                </VerticalStackLayout>
            </ScrollView>
        </Frame>
    </Frame>
</ContentView>
